<!--
  Generated template for the AnnoncesPage page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
    <ion-navbar *navbar hideBackButton>

        <button menuToggle>
            <ion-icon name='menu'></ion-icon>
        </button>

        <ion-segment [(ngModel)]="segment" (ionChange)="updateListMode()">
        <ion-segment-button value="list">
            Tous
        </ion-segment-button>
        <ion-segment-button value="favorites">
            Favoris
        </ion-segment-button>
        </ion-segment>
        <ion-buttons end>
        <button (click)="presentFilter()">
            <ion-icon ios="ios-options-outline" md="md-options"></ion-icon>
        </button>
        </ion-buttons>
    </ion-navbar>
    <ion-toolbar no-border-top>
        <ion-searchbar primary
                    [(ngModel)]="queryText"
                    (ionInput)="updateSchedule()"
                    placeholder="Rechercher">
        </ion-searchbar>
    </ion-toolbar>
</ion-header>


<ion-content padding class="annonces">
    <div [ngSwitch]="action">
        <form *ngSwitchWhen="'create'" [ngFormModel]="createForm" (ngSubmit)="create(createForm.value)">
            <input type="hidden" [(ngFormControl)]="createForm.controls['id']" />
            <ion-item>
                <ion-label floating>type</ion-label>
                <ion-select [(ngFormControl)]="createForm.controls['type']">
                    <ion-option value="Collocation">Logement</ion-option>
                    <ion-option value="Recherche">Recherche</ion-option>
                    <ion-option value="vente">vente</ion-option>
                </ion-select>
            </ion-item>
            <ion-item *ngIf="!createForm.controls.type.valid  && (submitAttempt || createForm.controls.type.touched)" >
                <p  class="invalid">Please select a type.</p>
            </ion-item>
            
            <ion-item>
                <ion-label floating>Titre</ion-label>
                <ion-input type="text" [(ngFormControl)]="createForm.controls['title']"></ion-input>
            </ion-item>
            <ion-item *ngIf="!createForm.controls.title.valid  && (submitAttempt || createForm.controls.title.touched)" >
                <p  class="invalid">Please enter a title.</p>
            </ion-item>
            
            <ion-item>
                <ion-label floating>Description</ion-label>
                <ion-textarea [(ngFormControl)]="createForm.controls['description']"></ion-textarea>
            </ion-item>
            <ion-item *ngIf="!createForm.controls.description.valid  && (submitAttempt || createForm.controls.description.touched)" >
                <p  class="invalid">Please enter a description.</p>
            </ion-item>
            
            <div padding>
                <button type="button" (click)="cancel()">Annuler</button>
                <button type="submit">Enregistrer</button>
            </div>
        </form>

        <ion-list *ngSwitchWhen="'list'">
            <ion-item-sliding *ngFor="let item of annonces | async">
                <button ion-item (click)="edit(item)">
                    <ion-item-content item-left>
                        <h2>{{item.title}}</h2>
                        <p>{{item.description | truncate: 40}}</p>
                    </ion-item-content>
                    <ion-icon name="star" item-right></ion-icon>                    
                </button>
                <ion-item-options>
                    <button danger (click)="delete(item)">
                        <ion-icon name="trash"></ion-icon> Delete
                    </button>
                </ion-item-options>
            </ion-item-sliding>
            <button class="round-overlay-button bottom-right positive light" (click)="add()">
                <ion-icon name="add"></ion-icon>
            </button>
        </ion-list>
        <ion-list *ngSwitchWhen="'favorites'">
            <ion-item-sliding *ngFor="let item of favorites">
                <button ion-item (click)="edit(item)">
                    <ion-item-content>
                        <h2>{{item.title}}</h2>
                        <p>{{item.description | truncate: 40}}</p>
                    </ion-item-content>
                </button>

                <ion-item-options>
                    <button danger (click)="delete(item)">
                        <ion-icon name="trash"></ion-icon> Delete</button>
                </ion-item-options>
            </ion-item-sliding>
            <button class="round-overlay-button bottom-right positive light" (click)="add()">
                <ion-icon name="add"></ion-icon>
            </button>
        </ion-list>
       </div>
</ion-content>